{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\drdgu\\\\source\\\\repos\\\\SPA_Sibintek\\\\SPA_Sibintek_NET6\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Md5 } from 'ts-md5/dist/md5';\nimport { saveAs } from 'file-saver';\nlet HomeComponent = class HomeComponent {\n  constructor(http, snackBar) {\n    this.http = http;\n    http.get('/api/v1/Files/').subscribe(result => {\n      this.files = result;\n    }, error => snackBar.open(error, 'close'));\n  }\n\n  onFileSelected($event) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const file = $event.target.files[0];\n      const fileBytes = new Uint8Array(yield file.arrayBuffer());\n\n      const md5 = _this.checkMD5(fileBytes);\n\n      console.log(md5);\n\n      if (_this.files.find(f => f.hash === md5) == null) {\n        _this.canUpload = true;\n        _this.selectedFile = file;\n        _this.selectedFileMD5 = md5;\n      } else {\n        _this.canUpload = false;\n      }\n    })();\n  }\n\n  uploadFile() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.canUpload = false;\n      const formData = new FormData();\n      formData.append('file', _this2.selectedFile);\n      formData.append('contentType', _this2.selectedFile.type);\n      formData.append('md5', _this2.selectedFileMD5);\n\n      _this2.http.post('api/v1/Files/Add/', formData).subscribe(result => {\n        alert('File uploaded.');\n\n        _this2.files.push(result);\n      }, error => {\n        _this2.canUpload = true;\n        console.error(error);\n        alert(error);\n      });\n    })();\n  }\n\n  downloadFile(file) {\n    this.http.get('api/v1/Files/Download/' + file.id, {\n      responseType: 'blob'\n    }).subscribe(result => {\n      saveAs(result, file.name);\n    }, error => {\n      console.error(error);\n      alert(error);\n    });\n  }\n\n  deleteFile(file) {\n    this.http.delete('api/v1/Files/Delete/' + file.id).subscribe(result => {\n      alert('File deleted.');\n      this.removeFileFormArray(file);\n    }, error => {\n      console.error(error);\n      alert(error);\n    });\n  }\n\n  removeFileFormArray(file) {\n    const index = this.files.indexOf(file, 0);\n\n    if (index > -1) {\n      this.files.splice(index, 1);\n    }\n  }\n\n  checkMD5(bytes) {\n    const md5 = new Md5();\n    md5.appendByteArray(bytes);\n    return md5.end();\n  }\n\n};\nHomeComponent = __decorate([Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html'\n})], HomeComponent);\nexport { HomeComponent };","map":{"version":3,"sources":["C:/Users/drdgu/source/repos/SPA_Sibintek/SPA_Sibintek_NET6/ClientApp/src/app/home/home.component.ts"],"names":["__decorate","Component","Md5","saveAs","HomeComponent","constructor","http","snackBar","get","subscribe","result","files","error","open","onFileSelected","$event","file","target","fileBytes","Uint8Array","arrayBuffer","md5","checkMD5","console","log","find","f","hash","canUpload","selectedFile","selectedFileMD5","uploadFile","formData","FormData","append","type","post","alert","push","downloadFile","id","responseType","name","deleteFile","delete","removeFileFormArray","index","indexOf","splice","bytes","appendByteArray","end","selector","templateUrl"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component } from '@angular/core';\r\nimport { Md5 } from 'ts-md5/dist/md5';\r\nimport { saveAs } from 'file-saver';\r\nlet HomeComponent = class HomeComponent {\r\n    constructor(http, snackBar) {\r\n        this.http = http;\r\n        http.get('/api/v1/Files/').subscribe(result => {\r\n            this.files = result;\r\n        }, error => snackBar.open(error, 'close'));\r\n    }\r\n    async onFileSelected($event) {\r\n        const file = $event.target.files[0];\r\n        const fileBytes = new Uint8Array(await file.arrayBuffer());\r\n        const md5 = this.checkMD5(fileBytes);\r\n        console.log(md5);\r\n        if (this.files.find(f => f.hash === md5) == null) {\r\n            this.canUpload = true;\r\n            this.selectedFile = file;\r\n            this.selectedFileMD5 = md5;\r\n        }\r\n        else {\r\n            this.canUpload = false;\r\n        }\r\n    }\r\n    async uploadFile() {\r\n        this.canUpload = false;\r\n        const formData = new FormData();\r\n        formData.append('file', this.selectedFile);\r\n        formData.append('contentType', this.selectedFile.type);\r\n        formData.append('md5', this.selectedFileMD5);\r\n        this.http.post('api/v1/Files/Add/', formData).subscribe(result => {\r\n            alert('File uploaded.');\r\n            this.files.push(result);\r\n        }, error => {\r\n            this.canUpload = true;\r\n            console.error(error);\r\n            alert(error);\r\n        });\r\n    }\r\n    downloadFile(file) {\r\n        this.http.get('api/v1/Files/Download/' + file.id, { responseType: 'blob' }).subscribe(result => {\r\n            saveAs(result, file.name);\r\n        }, error => {\r\n            console.error(error);\r\n            alert(error);\r\n        });\r\n    }\r\n    deleteFile(file) {\r\n        this.http.delete('api/v1/Files/Delete/' + file.id).subscribe(result => {\r\n            alert('File deleted.');\r\n            this.removeFileFormArray(file);\r\n        }, error => {\r\n            console.error(error);\r\n            alert(error);\r\n        });\r\n    }\r\n    removeFileFormArray(file) {\r\n        const index = this.files.indexOf(file, 0);\r\n        if (index > -1) {\r\n            this.files.splice(index, 1);\r\n        }\r\n    }\r\n    checkMD5(bytes) {\r\n        const md5 = new Md5();\r\n        md5.appendByteArray(bytes);\r\n        return md5.end();\r\n    }\r\n};\r\nHomeComponent = __decorate([\r\n    Component({\r\n        selector: 'app-home',\r\n        templateUrl: './home.component.html',\r\n    })\r\n], HomeComponent);\r\nexport { HomeComponent };\r\n"]},"metadata":{},"sourceType":"module"}